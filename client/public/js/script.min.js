/** @package VirtueMart Essentials @author Abhishek Das <info@virtueplanet.com> @copyright  Copyright (C) 2012-2019 VirtuePlanet Services LLP. All rights reserved. @license GNU General Public License version 2 or later; see LICENSE.txt @link https://www.virtueplanet.com */
var vme=window.vme||{};vme.base="",vme.itemid=0,function(a,b,c,d){b.addBtn=function(c,e){a(e).off("click").on("click",function(e){e.preventDefault();var f=a(this).closest("form"),g=a('input[name="virtuemart_product_id"]',f).val();return a.ajax({type:"POST",dataType:"JSON",url:b.base+"index.php?option=com_vmessentials&view="+c+"&format=json",data:f.serialize(),success:function(e){e.error||b.addedAction(c,g),e.msg&&b.showMessage(e.msg,e.error),a("body").trigger("updated."+c);var f=d.location!=d.parent.location;parent&&f&&parent.jQuery&&parent.jQuery("body").trigger("updated."+c)},error:function(a){console.log(a)}}),!1})},b.modRemoveBtn=function(c,e){a(e).off("click").on("click",function(e){e.preventDefault();var f=a(this).closest("form"),g=a('input[name="virtuemart_product_id"]',f).val();return a.ajax({type:"POST",dataType:"JSON",url:b.base+"index.php?option=com_vmessentials&view="+c+"&format=json",data:f.serialize(),success:function(e){e.error||b.removeAction(c,g),e.msg&&b.showMessage(e.msg,e.error),a("body").trigger("updated."+c);var f=d.location!=d.parent.location;parent&&f&&parent.jQuery&&parent.jQuery("body").trigger("updated."+c)},error:function(a){console.log(a)}}),!1})},b.updateMod=function(d){a(".vme-mod-"+d).length&&a.ajax({type:"GET",dataType:"JSON",url:b.base+"index.php?option=com_ajax&module=vme_"+d+"&method=get&format=json&Itemid="+b.itemid,beforeSend:function(){a(".vme-mod-"+d+" .vme-mod-loader").removeClass("vme-hide").fadeIn(100),a(".vme-mod-"+d+" .vme-mod-loader-wheel").removeClass("vme-hide").fadeIn(100)},success:function(b){if(b.html){"string"==a.type(b.html)&&(b.html=a.parseHTML(b.html));var e=a(b.html).find(".vme-mod-contents").html();e||(e=b.html),a(".vme-mod-"+d+" .vme-mod-contents").html(e),a(c).trigger("init.vmessentials")}},error:function(a){console.log(a)}})},b.addedAction=function(b,c){a("form.vmessentials-"+b+"-form").each(function(){a('input[name="virtuemart_product_id"][value="'+c+'"]',this).length&&a(this).addClass("vme-hide")}),a("a.vme-"+b+'-link[data-vmeid="'+c+'"]').removeClass("vme-hide").fadeIn(100),d.parent&&d.parent.document&&(a("form.vmessentials-"+b+"-form",d.parent.document).each(function(){a('input[name="virtuemart_product_id"][value="'+c+'"]',this).length&&a(this).addClass("vme-hide")}),a("a.vme-"+b+'-link[data-vmeid="'+c+'"]',d.parent.document).removeClass("vme-hide").fadeIn(100))},b.removeAction=function(b,c){a("a.vme-"+b+'-link[data-vmeid="'+c+'"]').addClass("vme-hide"),a("form.vmessentials-"+b+"-form").each(function(){a('input[name="virtuemart_product_id"][value="'+c+'"]',this).length&&a(this).removeClass("vme-hide").fadeIn(100)}),d.parent&&d.parent.document&&(a("a.vme-"+b+'-link[data-vmeid="'+c+'"]',d.parent.document).addClass("vme-hide"),a("form.vmessentials-"+b+"-form",d.parent.document).each(function(){a('input[name="virtuemart_product_id"][value="'+c+'"]',this).length&&a(this).removeClass("vme-hide").fadeIn(100)}))},b.msgTimer=null,b.msgTimerOut=null,b.showMessage=function(c,d){a("#vme-message-box").remove(),type=d?"vme-error":"vme-success";var e=a("<a/>",{href:"#",class:"vme-message-close",html:"&times;"}).off("click").on("click",function(a){return a.preventDefault(),b.hideMessage(),!1}),f=a("<div/>",{class:"vme-message-content",text:c}).append(e),g=a("<div/>",{class:"vme-message "+type}).append(f),h=a("<div/>",{id:"vme-message-box",class:"vme-fade",style:"display:block;"});h.append(g).appendTo("body"),b.msgTimer&&clearTimeout(b.msgTimer),b.msgTimerOut&&clearTimeout(b.msgTimerOut),b.msgTimer=setTimeout(function(){h.addClass("vme-in"),b.msgTimerOut=setTimeout(function(){b.hideMessage()},3e3)},50)},b.hideTimer=null,b.hideMessage=function(){b.hideTimer&&clearTimeout(b.hideTimer),a("#vme-message-box").removeClass("vme-in"),b.hideTimer=setTimeout(function(){a("#vme-message-box").hide()},150)},b.loadOptions=function(c="vme-script-options"){if(a("#"+c).html()){var e=JSON.parse(a("#"+c).html());e&&a.each(e,function(a,c){b[a]=c})}},a(c).off("init.vmessentials").on("init.vmessentials",function(){b.addBtn("compare","[data-vmecompare]"),b.addBtn("wishlist","[data-vmewishlist]"),b.modRemoveBtn("compare","[data-vmecompareremove]"),b.modRemoveBtn("wishlist","[data-vmewishlistremove]")}),a(function(){b.loadOptions(),a(c).trigger("init.vmessentials"),a(c).ajaxStop(function(){a(c).trigger("init.vmessentials"),a("#fancybox-content a").attr("target","_top"),a("#facebox .content a").attr("target","_top")}),a("body").on("updateVirtueMartCartModule",function(){var a=d.location!=d.parent.location;parent&&a&&parent.jQuery&&parent.jQuery("body").trigger("updateVirtueMartCartModule")}),a("body").on("updated.wishlist",function(){b.updateMod("wishlist")}),a("body").on("updated.compare",function(){b.updateMod("compare")}),a(".vme-quickview .addtocart-area a").attr("target","_top")})}(jQuery,vme,document,window);